<html window-icon="images/rx.ico" window-frame="extended" window-resizable>
<head>
<title>RenegadeX-Launcher</title>
<style>
  @import url(elements.css);
  @import url(containers.css);
  @import url(fonts.css);
  @import url(news.css);
  @import url(chat.css);
</style>
<script src="events.js" type="text/javascript"></script>
<script src="functional.js" type="text/javascript"></script>
<script type="text/javascript">
var sciter;
var sys;
var debug;

(async () => {
  sciter = await import("@sciter");
  sys = await import("@sys");
  debug = await import("@debug");

  debug.setUnhandledExeceptionHandler(function(err) {
    try {
      console.error(err.toString() + "\r\n" + err.stacktrace);
    } catch(e) {
      console.error("setUnhandledExceptionHandler:");
      console.error(printf("Caught exception: %s\n%V", e, e.stacktrace));;
    }
  });

  Element.prototype.load = function(file, base_url = undefined) {
    try {
      console.log("Called prototype load!");
      if(base_url != undefined) {
        console.log("Loading HTML into element:");
        console.log(this);
        this.content(file);
        return true;
      } else {
        console.log("Loading file \"" + file + "\" into element:");
        console.log(this);
        this.content(sciter.decode(sys.fs.$readfile("dom/" + file)));
        return true;
      }
    } catch(e) {
      console.error("Element.load:");
      console.error(printf("Caught exception: %s\n%V", e, e.stacktrace));;
    }
  };
  try {
    document.$("#content").load(document.$("div.current").getAttribute("page"));
    set_current_page(document.$("div.current"));
    Window.this.xcall("check_launcher_update", check_launcher_result);
    initialize_variables();
    Window.this.xcall("get_servers", getServersCallback);
    load_news_feed();
  } catch(e) {
    console.error("frontpage.htm");
    console.error(printf("Caught exception: %s\n%V", e, e.stacktrace));;
  }
})();

</script>
</head>
<body model="Data">
  <div#header style="background-color: #0D1721; margin-top: 2px;">
    <div.headerSpacer.left>
      <a.facebook href="https://www.facebook.com/RenXFirestorm/" target="@system"></a>
      <a.twitter href="https://twitter.com/renxgame" target="@system"></a>
      <a.discord href="https://ren-x.com/discord" target="@system"></a>
      <a.youtube href="https://www.youtube.com/channel/UCaiic-yEcwEv8VG6wRaHcDQ" target="@system"></a>
    </div>
    <div.spacer role="window-caption"></div>
    <div.menuEntries>
      <div page="news.htm">NEWS</div>
      <div.current page="game.htm">PLAY GAME</div>
      <div overlay="settings.htm">SETTINGS</div>
    </div>
    <div.spacer role="window-caption"></div>
    <div.headerSpacer.right>
      <button.minimize role="window-minimize"></button>
      <button.maximize role="window-maximize"></button>
      <button.close role="window-close"></button>
    </div>
  </div>

  <div#overlay></div>
  <div#content></div>
</body>
</html>
